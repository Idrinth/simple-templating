"use strict";(t=>{const e="object",r="each",n="if",i="{%",s="%}",o="",h=".",u={t:"key",e:"value",r:"pos",n:"even"};class f{constructor(t){this.i=t,this.s=t.split(h)}find(t){let e=t;for(let t of this.s){if(void 0===e[t])return o;e=e[t]}return e}o(t){return 1===this.s.length?t[this.i]:(void 0===t.h[this.i]&&(t.h[this.i]=this.find(t)),t.h[this.i])}}class l extends f{constructor(t,e){let r="!"===t.charAt(0);super(r?t.substr(1):t),this.u=e,this.f=r}render(t){return!!this.o(t)===this.f?o:this.u.render(t)}}class d extends f{constructor(t,e){super(t),this.u=e,this.l=t,this.d="_"+t.replace(h,"#")}c(t){let e=new Array(t.length);for(let r=t.length-1;r>=0;r--)e[r]=this.a(t[r]);return e}w(t){let e={};for(let r in t)e[r]=this.a(t[r]);return e}a(t){return typeof t!==e||null===t?t:t.constructor===Array?this.c(t):this.w(t)}p(t,e,r,n){let i={};i[u.t]=r,i[u.e]=e[r],i[u.r]=n,i[u.n]=!(n%2);for(let e in u)t.h[this.d+h+e]=i[e];return t[this.d]=i,this.u.render(t)}render(t){let r=this.o(t);if(!r)return o;if(typeof r!==e)return o;let n=[r,this.a(t),o];return r.constructor===Array&&this.y(...n),this.v(...n)}y(t,e,r){for(let n=0;n<t.length;n++)r+=this.p(e,t,n,n);return r}v(t,e,r){let n=0;for(let i in t)r+=this.p(e,t,i,n),n++;return r}}class c extends f{g(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";default:return"&#039;"}}render(t){return(this.o(t)+o).replace(/[&<"'>]/g,this.g)}}class a{constructor(t){this.b=t}render(t){return this.b}}class w{constructor(t){this.m=this.x(t)}x(t){if(!t||"string"!=typeof t)return[];let e=[],r=-1;for(;(r=t.indexOf("{{"))>-1;){r>0&&(e.push(new a(t.substr(0,r))),t=t.substr(r));let n=t.indexOf("}}"),i=t.substr(2,n-2);t=t.substr(n+2),e.push(new c(i))}return e.push(new a(t)),e}render(t){let e=o;for(let r of this.m)e+=r.render(t);return e}}class p{constructor(t){this.m=[];let e=0;for(;(e=t.indexOf(i))>-1;){e>0&&this.m.push(new w(t.substring(0,e)));let r=(t=t.substring(e+2)).indexOf(s),n=t.substring(0,r).split(" "),i=this.k(t,r+2);this.A(n[0],n[1],new p(t.substring(r+2,i))),t=t.substring(i+7)}this.m.push(new w(t))}A(t,e,i){if(t===r)return this.m.push(new d(e,i));if(t===n)return this.m.push(new l(e,i));throw new Error("Token "+t+" is invalid.")}j(t){return t===r||t===n?1:-1}k(t,e){let r=e,n=1;for(;(e=t.indexOf(i,r))>-1;){r=t.indexOf(s,e);let i=t.substring(e+2,r).split(" ");if(0===(n+=this.j(i[0])))return e;r+=2}throw new Error("can't find end.")}render(t){t.h={};let e=o;for(let r=0;r<this.m.length;r++)e+=this.m[r].render(t);return e}}"undefined"!=typeof module&&void 0!==module.exports?module.exports=p:"function"==typeof define&&define.q?define([],()=>p):(t=>{if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;if(void 0!==t)return t;throw new Error("nothing to attach to found")})(t).Template=p})(this);